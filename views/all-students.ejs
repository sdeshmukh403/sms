<% include ../partials/header.html %>
<% include ../partials/nav.html %>
<% include ../partials/sidebar.html %>
<% include ../partials/list-breadcum.html %>
<% include ../partials/filter.html %>
<% include ../partials/success.html %>          
                        <div class="table-responsive">
                            <table class="table display data-table text-nowrap">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>
                                            <div class="form-check">
                                                <input type="checkbox" class="form-check-input checkAll">
                                                <label class="form-check-label">Roll No</label>
                                            </div>
                                        </th>
                                        <th>Photo</th>
                                        <th>Name</th>
                                        <th>Gender</th>
                                        <th>Class</th>
                                        <th>Section</th>
                                        <th>Parents</th>
                                        <th>Date Of Birth</th>
                                        <th>Phone</th>
                                        <th>E-mail</th>                                      
                                    </tr>
                                </thead>
                                <tbody>
                                    <% if (typeof data != "undefined" && data != null) { %>
                                        <% for(let student of data) { %> 
                                    <tr>
                                        <td>
                                            <div class="dropdown">
                                                <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                                                    aria-expanded="false">
                                                    <span class="flaticon-more-button-of-three-dots"></span>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-right">
                                                    <a class="dropdown-item" href="view-student/<%= student.id %>"><i
                                                        class="fas fa-eye text-default-peel"></i>View</a>                                      
                                                    <a class="dropdown-item" href="delete-user/<%= student.id %>"><i
                                                            class="fas fa-times text-orange-red"></i>Delete</a>
                                                    <a class="dropdown-item" href="/edit-student/<%= student.id %>"><i
                                                            class="fas fa-edit text-dark-pastel-green"></i>Edit</a>
                                                     </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input type="checkbox" class="form-check-input checkOne" value="<%= student.id %>">
                                                <label class="form-check-label"><%= student.roll_no %></label>
                                            </div>
                                        </td>
                                        <td class="text-center"><img src="img/figure/student2.png" alt="student"></td>
                                        <td><%= student.firstname + " " + student.lastname %></td>
                                        <td><%= helper.gender_name(student.gender) %></td>
                                        <td><%= student.class %></td>
                                        <td><%= student.section_id %></td>
                                        <td><%= student.parent_id %></td>
                                        <td><%= helper.convertDate(student.dob) %></td>
                                        <td><%= student.phone %></td>
                                        <td><%= student.email %></td>                                        
                                    </tr>
                                    <% }
                                        } %> 
   
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <% include ../partials/fadeout.html %>
                    <% include ../partials/footer.html %>
                    
<script>
$('.deleteChecked').click(function(){
    checkedStudents = [];
    i = 0;
    $(".checkOne:checked").each(function(){
     checkedStudents[i++] = $(this).val();       
    });
    $.ajax({
        type:'POST',
        url:'/students-bulk-delete',
        data:{checkedStudents},        
        success:function(result){
            html = '<div class="alert alert-success default" ><strong>Success!</strong> '+result.msg+'</div>'
            $('.json-msg').html(html)
          window.setTimeout(function(){location.reload()},3000)
        }
    })
});
$('.addNew'). attr("href", '/student-admission-form');
</script>